<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<title>COMPLEXO ESCOLAR TECNOLOGIA E INOVA√á√ÉO</title>
<style>
body { font-family: Arial, sans-serif; background: #f7f7f7; margin: 0; padding: 0; }
h1 { text-align: center; color: #2c3e50; margin-top: 20px; }

/* Container principal */
.container {
    display: flex;
    flex-wrap: wrap;
    justify-content: space-between;
    width: 90%;
    max-width: 1200px;
    margin: 20px auto;
    gap: 20px;
}

/* Chatbot √† esquerda */
#chatbot-box {
    flex: 1 1 350px;
    background: white;
    border-radius: 12px;
    padding: 20px;
    box-shadow: 0 0 12px rgba(0,0,0,0.1);
    max-height: 600px;
    overflow-y: auto;
}
#chatbot-box h2 { margin-top: 0; font-size: 18px; color: #2c3e50; }
#chatbot-box input, #chatbot-box textarea, #chatbot-box button {
    width: 100%; margin: 5px 0; padding: 8px;
    border-radius: 6px; border: 1px solid #ccc; box-sizing: border-box;
}
#chatbot-box button {
    background: #3498db; color: white; border: none; cursor: pointer;
}
#chatbot-box button:hover { background: #2980b9; }
.resposta-automatica { 
    margin-top: 10px; padding: 8px; background: #ecf0f1; 
    border-radius: 8px; font-size: 14px; color: #2c3e50; 
    white-space: pre-line; /* Para manter as quebras de linha */
}

/* Coluna arquivos √† direita */
.col-arquivos {
    flex: 1 1 600px;
}
.box {
    background: white; padding: 20px; border-radius: 12px; 
    box-shadow: 0 0 12px rgba(0,0,0,0.1); margin-bottom: 20px;
}
.box ul { list-style: none; padding: 0; }
.box li { padding: 10px; margin-bottom: 10px; border-bottom: 1px solid #eee; }
.preview-img, .preview-pdf { 
    width: 100%; max-height: 200px; margin-top: 5px; 
    border-radius: 8px; border: 1px solid #ccc; 
    object-fit: contain; /* Para manter a propor√ß√£o da imagem */
}
.preview-pdf iframe { width: 100%; height: 200px; border-radius: 8px; }

/* Notifica√ß√£o */
.notificacao {
    position: fixed; top: 20px; right: 20px;
    background: #4caf50; color: white; padding: 10px 20px;
    border-radius: 6px; display: none; box-shadow: 0 0 10px rgba(0,0,0,0.2);
    z-index: 1000;
}

/* Bot√µes de administra√ß√£o */
.admin-buttons {
    margin-top: 20px;
    padding: 15px;
    background: #f8f9fa;
    border-radius: 8px;
    border: 1px solid #ddd;
}
.admin-buttons h3 { margin-top: 0; }
.admin-buttons a {
    display: inline-block;
    margin: 5px;
    padding: 8px 15px;
    background: #17a2b8;
    color: white;
    text-decoration: none;
    border-radius: 4px;
}
.admin-buttons a:hover { background: #138496; }
</style>
</head>
<body>

<h1>üìÅ COMPLEXO ESCOLAR TECNOLOGIA E INOVA√á√ÉO</h1>

<div class="container">
    <!-- Chatbot -->
    <div id="chatbot-box">
        <h2>ü§ñ CLAUDBOT</h2>
        <form method="post" id="form-chatbot">
            <input type="text" name="mensagem" placeholder="Fa√ßa uma pergunta..." required>
            <button type="submit">üîç Perguntar</button>
        </form>
        
        {% if resposta %}
        <div class="resposta-automatica">{{ resposta }}</div>
        {% endif %}

        <hr>
        <h2>üì§ Enviar Arquivo</h2>
        <form action="/upload" method="post" enctype="multipart/form-data" id="form-upload">
            <input type="text" name="nome" placeholder="Seu nome" required>
            <input type="text" name="contacto" placeholder="Seu contacto" required>
            <textarea name="comentario" placeholder="Coment√°rio"></textarea>
            <input type="file" name="arquivo" required>
            <button type="submit">üì• Enviar</button>
        </form>

        <hr>
        <h2>üì¢ Reclama√ß√£o/Sugest√£o</h2>
        <form action="/feedback" method="post" id="form-feedback">
            <input type="text" name="encarregado" placeholder="Nome do Encarregado" required>
            <input type="text" name="aluno" placeholder="Nome do Aluno" required>
            <input type="text" name="contacto" placeholder="Contacto" required>
            <textarea name="mensagem" rows="3" placeholder="Digite sua mensagem..." required></textarea>
            <button type="submit">üì§ Enviar</button>
        </form>
        
        <!-- √Årea de administra√ß√£o -->
        <div class="admin-buttons">
            <h3>üîß Administra√ß√£o</h3>
            <a href="/upload_arquivos">Upload de Arquivos</a>
            <a href="/exportar/conversas">Exportar Conversas</a>
            <a href="/exportar/envios">Exportar Envios</a>
            <a href="/exportar/feedback">Exportar Feedback</a>
            <a href="/baixar_recebidos">Baixar Arquivos Recebidos</a>
            <a href="/login_dados">Visualizar Dados Recebidos</a>
        </div>
    </div>

    <!-- Arquivos -->
    <div class="col-arquivos">
        <div class="box">
            <h2>üìÇ Arquivos Dispon√≠veis</h2>
            <ul>
            {% for arquivo in arquivos %}
                <li>
                    {{ arquivo }} [<a href="{{ url_for('download', nome_arquivo=arquivo) }}">baixar</a>]
                    <div>
                    {% set ext = arquivo.split('.')[-1].lower() %}
                    {% if ext in ['jpg','jpeg','png','gif','bmp','webp'] %}
                        <img src="{{ url_for('visualizar_arquivo', nome_arquivo=arquivo) }}" class="preview-img" onerror="this.style.display='none'">
                    {% elif ext == 'pdf' %}
                        <iframe src="{{ url_for('visualizar_arquivo', nome_arquivo=arquivo) }}" class="preview-pdf" onerror="this.style.display='none'"></iframe>
                    {% else %}
                        <p>Preview n√£o dispon√≠vel para este tipo de arquivo.</p>
                    {% endif %}
                    </div>
                </li>
            {% else %}
                <li>Nenhum arquivo dispon√≠vel</li>
            {% endfor %}
            </ul>
        </div>
    </div>
</div>

<div class="notificacao" id="notificacao">‚úÖ Nova mensagem ou arquivo recebido!</div>

<script>
// Mostra notifica√ß√£o tempor√°ria
function mostrarNotificacao(msg) {
    const notif = document.getElementById("notificacao");
    notif.innerText = msg;
    notif.style.display = "block";
    setTimeout(() => { notif.style.display = "none"; }, 5000);
}

// Captura envio de formul√°rio e mostra notifica√ß√£o
document.getElementById('form-upload').addEventListener('submit', () => {
    mostrarNotificacao('üì• Arquivo enviado com sucesso!');
});
document.getElementById('form-feedback').addEventListener('submit', () => {
    mostrarNotificacao('üì¢ Feedback enviado com sucesso!');
});
document.getElementById('form-chatbot').addEventListener('submit', () => {
    mostrarNotificacao('ü§ñ Pergunta enviada ao chatbot!');
});
</script>

</body>
</html>